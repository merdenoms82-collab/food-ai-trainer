<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>DarsNest | AI Kitchen OS</title>

  <!-- PWA -->
  <meta name="theme-color" content="#0B0F1A" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="DarsNest" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="format-detection" content="telephone=no" />

  <link rel="apple-touch-icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üç≥</text></svg>">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Your CSS -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- App Shell -->
  <div class="app-shell">
    <!-- Safe Area Top -->
    <div class="safe-area-top"></div>

    <!-- Header (keep IDs the same for your JS) -->
    <header class="app-header">
      <div class="logo" id="brandLogo">
        <!-- Replace this icon with your real logo later -->
        <div class="logo-icon" aria-hidden="true">
          <i class="fas fa-robot"></i>
        </div>
        <div class="logo-text">DarsNest</div>
      </div>

      <div class="header-actions">
        <button class="header-btn" id="notificationBtn" aria-label="Notifications">
          <i class="fas fa-bell"></i>
        </button>
        <button class="header-btn" id="installBtn" style="display:none;" aria-label="Install App">
          <i class="fas fa-download"></i>
        </button>
      </div>
    </header>

    <!-- Chef Maya Welcome Modal (Onboarding only; not execution help) -->
    <div class="welcome-modal" id="welcomeModal" aria-hidden="true">
      <div class="welcome-content">
        <div class="chef-avatar">
          <div class="avatar-icon" aria-hidden="true">üë©‚Äçüç≥</div>
        </div>
        <div class="welcome-text">
          <h2>Hi, I‚Äôm Chef Maya</h2>
          <p>Add a few pantry staples to start. Then we‚Äôll build a money-smart week.</p>
        </div>
        <button class="btn btn-primary" id="startOnboardingBtn">
          <i class="fas fa-bolt"></i>
          Get Started
        </button>
      </div>
    </div>

    <!-- Pages -->
    <main class="page-container">
      <!-- HOME -->
      <section class="page home-page active" id="homePage">
        <div class="welcome-card">
          <h1>Welcome back</h1>
          <p>Pick recipes like a financial decision. Cook like a pro.</p>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value" id="totalItemsCount">0</div>
            <div class="stat-label">Total Items</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="freshItemsCount">0</div>
            <div class="stat-label">Fresh</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="expiringItemsCount">0</div>
            <div class="stat-label">Expiring</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="expiredItemsCount">0</div>
            <div class="stat-label">Expired</div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
          <button class="action-card" type="button" data-action="scan">
            <div class="action-title">Smart Scan</div>
            <div class="action-subtitle">AI-powered detection</div>
          </button>

          <button class="action-card" type="button" data-action="pantry-staples">
            <div class="action-title">Pantry Staples</div>
            <div class="action-subtitle">Quick add basics</div>
          </button>

          <button class="action-card" type="button" data-action="recipes">
            <div class="action-title">Recipes</div>
            <div class="action-subtitle">Savings-first picks</div>
          </button>

          <button class="action-card" type="button" data-action="shopping">
            <div class="action-title">Shopping</div>
            <div class="action-subtitle">Auto list & totals</div>
          </button>
        </div>

        <!-- Recent Items -->
        <div class="section-header">
          <div class="section-title">Recent Items</div>
          <a href="#" class="view-all-btn" id="viewAllBtn">View All</a>
        </div>

        <div class="pantry-items" id="homePantryItems">
          <!-- JS inject -->
        </div>
      </section>

      <!-- PANTRY -->
      <section class="page pantry-page" id="pantryPage">
        <h1 class="page-title">Pantry</h1>

        <div class="pantry-toolbar" style="display:flex; gap:10px; margin-bottom:16px; position:relative;">
          <div class="search-bar" style="flex:1;">
            <i class="fas fa-search" aria-hidden="true"></i>
            <input type="text" class="search-input" placeholder="Search items..." id="pantrySearch" />
          </div>

          <button class="add-item-btn" id="addItemBtn" type="button" aria-label="Add">
            <i class="fas fa-plus"></i>
          </button>

          <!-- Add Menu -->
          <div class="add-menu" id="addMenu" role="menu" aria-hidden="true">
            <div class="menu-item" role="menuitem" tabindex="0" data-action="pantry-staples">
              <div class="menu-icon"><i class="fas fa-bolt"></i></div>
              <div class="menu-text">Pantry Staples</div>
            </div>
            <div class="menu-item" role="menuitem" tabindex="0" data-action="scan">
              <div class="menu-icon"><i class="fas fa-camera"></i></div>
              <div class="menu-text">Scan Item</div>
            </div>
            <div class="menu-item" role="menuitem" tabindex="0" data-action="manual-add">
              <div class="menu-icon"><i class="fas fa-keyboard"></i></div>
              <div class="menu-text">Manual Add</div>
            </div>
          </div>
        </div>

        <div class="pantry-categories">
          <div class="category-tab active" data-category="all">All</div>
          <div class="category-tab" data-category="produce">Produce</div>
          <div class="category-tab" data-category="meat">Meat</div>
          <div class="category-tab" data-category="dairy">Dairy</div>
          <div class="category-tab" data-category="grains">Grains</div>
          <div class="category-tab" data-category="spices">Spices</div>
        </div>

        <div class="pantry-grid" id="pantryGrid">
          <!-- JS inject -->
        </div>
      </section>

      <!-- SCANNER -->
      <section class="page scanner-page" id="scannerPage">
        <div class="scanner-demo">
          <div class="scanner-preview">
            <div class="scan-line"></div>
            <div id="scannedItemEmoji" aria-hidden="true">üçé</div>
          </div>
          <div style="font-weight:700; margin-bottom:6px;">Scanner Demo</div>
          <div style="opacity:.8; font-size:.95rem;">For fresh groceries and pantry adds</div>
        </div>

        <div class="scanner-title">AI Scanner</div>
        <div class="scanner-subtitle">Scan an item to add it fast</div>

        <button class="btn btn-primary" id="startScanBtn" type="button" style="max-width:220px; margin:0 auto;">
          <i class="fas fa-camera"></i>
          Start Demo Scan
        </button>

        <div class="scanner-options">
          <button class="btn btn-secondary" id="uploadPhotoBtn" type="button">
            <i class="fas fa-upload"></i>
            Upload Photo
          </button>
        </div>
      </section>

      <!-- RECIPES -->
      <section class="page recipes-page" id="recipesPage">
        <div class="recipes-tabs">
          <div class="recipes-tab active" data-tab="ai-recipes">AI Recipes</div>
          <div class="recipes-tab" data-tab="my-recipes">My Recipes</div>
          <div class="recipes-tab" data-tab="favorites">Favorites</div>
        </div>

        <!-- AI Recipes (Selection Mode grid) -->
        <div class="recipes-tab-content active" id="aiRecipesTab">
          <div class="section-header">
            <div>
              <div class="section-title">AI Recipes</div>
              <div class="section-subtitle">Savings-first picks based on your pantry</div>
            </div>
          </div>

          <!-- 2-column grid, 4:5 cards (CSS handles) -->
          <div class="recipes-grid" id="recipesGrid">
            <!-- JS inject Selection Mode cards with this locked hierarchy:
                 1) Image (top 50%)
                 2) Recipe Name
                 3) Restaurant Price (red muted)
                 4) Home Cost (white)
                 5) YOU SAVE $X (green dominant)
                 6) Readiness text (e.g., "82% Ingredients Ready")
                 7) Add to Week button
            -->
          </div>
        </div>

        <!-- My Recipes -->
        <div class="recipes-tab-content" id="myRecipesTab">
          <div class="section-header">
            <div class="section-title">My Recipes</div>
            <button class="btn btn-secondary" id="addRecipeBtn" type="button">
              <i class="fas fa-plus"></i>
              New
            </button>
          </div>

          <div class="recipes-grid" id="myRecipesGrid">
            <!-- JS inject -->
          </div>
        </div>

        <!-- Favorites -->
        <div class="recipes-tab-content" id="favoritesTab">
          <div class="section-header">
            <div class="section-title">Favorites</div>
          </div>

          <div class="recipes-grid" id="favoritesGrid">
            <!-- JS inject -->
          </div>
        </div>
      </section>

      <!-- SHOPPING -->
      <section class="page shopping-page" id="shoppingPage">
        <div class="shopping-header">
          <div class="section-title">Shopping List</div>
          <div class="shopping-actions">
            <button class="btn btn-secondary" id="findCouponsBtn" type="button">
              <i class="fas fa-tag"></i>
              Coupons
            </button>
            <button class="btn btn-secondary" id="clearShoppingBtn" type="button">
              <i class="fas fa-trash"></i>
              Clear
            </button>
          </div>
        </div>

        <div class="shopping-summary">
          <div class="summary-card">
            <div class="summary-value" id="totalItems">0</div>
            <div class="summary-label">Items</div>
          </div>
          <div class="summary-card">
            <div class="summary-value" id="estimatedCost">$0.00</div>
            <div class="summary-label">Home Cost</div>
          </div>
          <div class="summary-card">
            <div class="summary-value" id="estimatedSavings">$0.00</div>
            <div class="summary-label">Savings</div>
          </div>
        </div>

        <div class="coupons-section" id="couponsSection" style="display:none;">
          <div class="section-header">
            <div class="section-title"><i class="fas fa-tag"></i> Available Coupons</div>
          </div>
          <div class="coupons-grid" id="couponsGrid"></div>
        </div>

        <div class="shopping-list" id="shoppingList">
          <!-- JS inject -->
        </div>

        <div class="shopping-actions-footer">
          <button class="btn btn-primary" id="generateShoppingBtn" type="button">
            <i class="fas fa-magic"></i>
            Generate from Missing Items
          </button>
        </div>
      </section>

      <!-- MEAL PLANNER (Execution Mode) -->
      <section class="page meal-planner-page" id="mealPlannerPage">
        <!-- Sticky Weekly Savings Header (LOCKED) -->
        <div class="weekly-savings-header" id="weeklySavingsHeader">
          <div class="weekly-row">
            <div class="weekly-metric">
              <div class="weekly-label">Restaurant</div>
              <div class="weekly-value weekly-restaurant" id="weeklyRestaurantTotal">$0</div>
            </div>
            <div class="weekly-metric">
              <div class="weekly-label">Home</div>
              <div class="weekly-value" id="weeklyHomeTotal">$0</div>
            </div>
          </div>
          <div class="weekly-headline">
            <div class="weekly-label">YOU SAVE THIS WEEK</div>
            <div class="weekly-save" id="weeklySavingsTotal">$0</div>
          </div>
        </div>

        <div class="section-header" style="margin-top:16px;">
          <div class="section-title">Weekly Calendar</div>
          <button class="btn btn-secondary" id="generateMealPlanBtn" type="button">
            <i class="fas fa-calendar-alt"></i>
            Auto Plan
          </button>
        </div>

        <div class="week-calendar" id="weekCalendar">
          <!-- JS inject 7-day grid (Mon‚ÄìSun) -->
        </div>

        <div class="prep-tips" id="prepTips">
          <div class="section-header">
            <div class="section-title"><i class="fas fa-lightbulb"></i> Prep Tips</div>
          </div>
          <div class="tips-content" id="tipsContent">
            <p>No plan yet. Add recipes to days and we‚Äôll guide execution.</p>
          </div>
        </div>
      </section>
    </main>

    <!-- Tab Bar -->
    <nav class="tab-bar">
      <a href="#" class="tab-item active" data-page="home" aria-label="Home">
        <div class="tab-icon"><i class="fas fa-home"></i></div>
        <div class="tab-label">Home</div>
      </a>

      <a href="#" class="tab-item" data-page="pantry" aria-label="Pantry">
        <div class="tab-icon"><i class="fas fa-box"></i></div>
        <div class="tab-label">Pantry</div>
      </a>

      <a href="#" class="tab-item" data-page="scanner" aria-label="Scan">
        <div class="tab-icon"><i class="fas fa-camera"></i></div>
        <div class="tab-label">Scan</div>
      </a>

      <a href="#" class="tab-item" data-page="recipes" aria-label="Recipes">
        <div class="tab-icon"><i class="fas fa-utensils"></i></div>
        <div class="tab-label">Recipes</div>
      </a>

      <a href="#" class="tab-item" data-page="meal-planner" aria-label="Plan">
        <div class="tab-icon"><i class="fas fa-calendar-alt"></i></div>
        <div class="tab-label">Plan</div>
      </a>
    </nav>

    <!-- Safe Area Bottom -->
    <div class="safe-area-bottom"></div>
  </div>

  <!-- Backdrop -->
  <div class="backdrop" id="backdrop"></div>

  <!-- Pantry Staples Modal -->
  <div class="pantry-staples-modal" id="pantryStaplesModal" aria-hidden="true">
    <div class="modal-header">
      <div class="modal-handle" aria-hidden="true"></div>
      <div class="modal-title">Quick Add Pantry Staples</div>
      <button class="modal-close" id="closeStaplesModalBtn" aria-label="Close">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="modal-content">
      <p class="modal-subtitle">Select staples you already have:</p>
      <div class="staples-grid" id="staplesGrid">
        <!-- JS inject -->
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" id="skipStaplesBtn" type="button">Skip</button>
      <button class="btn btn-primary" id="saveStaplesBtn" type="button">
        <i class="fas fa-check"></i>
        Add to Pantry
      </button>
    </div>
  </div>

  <!-- Recipe Details Modal (Execution Mode screen container) -->
  <div class="recipe-modal" id="recipeModal" aria-hidden="true">
    <div class="modal-header">
      <div class="modal-handle" aria-hidden="true"></div>
      <button class="modal-close" id="closeRecipeModalBtn" aria-label="Close">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <!-- JS inject Execution Mode layout in this locked order:
         Recipe Name
         Portion Size/Scaling Controls
         Full Ingredient List (toggles + quantities)
         Cooking Steps
         Chef Maya Panel (collapsible)
         Optional Cost Breakdown (collapsed)
    -->
    <div class="recipe-modal-content" id="recipeModalContent"></div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification" aria-live="polite">
    <div class="notification-content">
      <div class="notification-icon" id="notificationIcon"></div>
      <div class="notification-text" id="notificationText"></div>
    </div>
  </div>

  <!-- Your JS -->
  <script src="script.js"></script>
</body>
</html>
